<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><title>Roy Lau</title><link rel="shortcut icon" href="/blog/images/favicon.jpg"><link rel="alternate" href="/blog/atom.xml" title="Roy Lau"><meta name="description" content="docker 镜像使用相关命令安装使用（nginx，tomcat，mysql，oracle 11g）容器使用镜像使用容器链接Docker 镜像使用当运行容器时，使用的镜像如果在本地中不存在，docker 就会自动从 docker 镜像仓库中下载，默认是从 Docker Hub 公共镜像源下载。主要学习点：1、管理和使用本地 Docker 主机镜像 2、创建镜像 列出镜像列表我们可以使用 docke"><meta property="og:type" content="article"><meta property="og:title" content="Roy Lau"><meta property="og:url" content="https://roy-lau.github.io/blog/2019/06/12/Linux/centOS/docker/image-usage/index.html"><meta property="og:site_name" content="Roy Lau"><meta property="og:description" content="docker 镜像使用相关命令安装使用（nginx，tomcat，mysql，oracle 11g）容器使用镜像使用容器链接Docker 镜像使用当运行容器时，使用的镜像如果在本地中不存在，docker 就会自动从 docker 镜像仓库中下载，默认是从 Docker Hub 公共镜像源下载。主要学习点：1、管理和使用本地 Docker 主机镜像 2、创建镜像 列出镜像列表我们可以使用 docke"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2019-06-12T07:21:24.600Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Roy Lau"><meta name="twitter:description" content="docker 镜像使用相关命令安装使用（nginx，tomcat，mysql，oracle 11g）容器使用镜像使用容器链接Docker 镜像使用当运行容器时，使用的镜像如果在本地中不存在，docker 就会自动从 docker 镜像仓库中下载，默认是从 Docker Hub 公共镜像源下载。主要学习点：1、管理和使用本地 Docker 主机镜像 2、创建镜像 列出镜像列表我们可以使用 docke"><meta name="format-detection" content="telephone=no,email=no"><meta name="theme-color" content="#9C27B0"><meta name="description" content><meta name="keywords" content><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="Roy Lau"><meta name="msapplication-starturl" content="https://roy-lau.github.io/blog/blog/2019/06/12/Linux/centOS/docker/image-usage/"><meta name="msapplication-navbutton-color" content="#9C27B0"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Roy Lau"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/blog/images/favicon.jpg"><meta property="article:published_time" content="Wed Jun 12 2019 07:21:24 GMT+0000"><meta property="article:modified_time" content="Wed Jun 12 2019 15:21:24 GMT+0800"><link rel="canonical" href="https://roy-lau.github.io/blog/blog/2019/06/12/Linux/centOS/docker/image-usage/"><meta name="google-site-verification" content="fXjtlIfaDc_X-0P11rO3bEp1Nk4IKXphoJv0GqGZCco"><meta name="baidu-site-verification" content="I3t1wfwZvd"><script>!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script"),ga("create","UA-139531378-1","auto"),ga("send","pageview")</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?1054d51c0b66f1d168829173682c8159";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="stylesheet" href="/blog/css/mdui.css"><link rel="stylesheet" href="/blog/css/style.css"></head><body class="mdui-appbar-with-toolbar mdui-drawer-body-left mdui-theme-primary-brown mdui-theme-accent-blue"><script>var a=localStorage.getItem("mdui-theme-layout-dark");a&&(document.getElementsByTagName("body")[0].className+=" mdui-theme-layout-dark")</script><header id="header" class="mdui-appbar mdui-appbar-fixed mdui-appbar-scroll-hide mdui-appbar-inset"><div class="mdui-toolbar mdui-color-theme"><a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="mdui-icon material-icons">menu</i></a> <a href="/blog/" class="mdui-typo-headline">Roy Lau</a><div class="mdui-toolbar-spacer"></div><a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: '搜索'}"><i class="mdui-icon material-icons">search</i></a> <a href="/blog/atom.xml" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: 'RSS'}"><i class="mdui-icon material-icons">rss_feed</i></a></div></header><div class="mdui-dialog" id="search"><div class="search-form"><input type="search" class="search-form-input" placeholder="请输入关键字"></div><div class="search-result" data-resource="/blog/search.xml"></div></div><aside id="sidebar" class="mdui-drawer mdui-drawer-full-height"><div class="mdui-grid-tile"><img src="/blog/imgs/banner.png" style="height:160px"> <img src="/blog/imgs/avatar.png" class="avatar-animation" style="position:absolute;top:10%;left:50px;width:64px;height:64px;border:2px solid #fff;border-radius:50%"><div class="mdui-grid-tile-actions"><div class="mdui-grid-tile-text"><div class="mdui-grid-tile-title">Roy Lau</div><div class="mdui-grid-tile-subtitle"><i class="mdui-icon material-icons">art_track</i>是否能写好博客，在于坚持认真。</div></div><div class="mdui-grid-tile-buttons"><a href="mailto:897379293@qq.com" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: '897379293@qq.com'}"><i class="mdui-icon material-icons">email</i></a></div></div></div><div class="mdui-list" mdui-collapse="{accordion: true}"><a href="/blog/" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">home</i><div class="mdui-list-item-content">主页</div></a><div class="mdui-collapse-item"><div class="mdui-collapse-item-header mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-green">chrome_reader_mode</i><div class="mdui-list-item-content">分类</div><i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i></div><div class="mdui-collapse-item-body mdui-list mdui-list-dense"><a class="mdui-ripple sidebar_archives-link" href="/blog/categories/DB/">DB<span class="mdui-ripple sidebar_archives-count">18</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/categories/DB/MongoDB/">MongoDB<span class="mdui-ripple sidebar_archives-count">18</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/categories/hexo/">hexo<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/categories/install-package/">install-package<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/categories/windows/">windows<span class="mdui-ripple sidebar_archives-count">1</span></a></div></div><div class="mdui-collapse-item"><div class="mdui-collapse-item-header mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-deep-orange">inbox</i><div class="mdui-list-item-content">归档</div><i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i></div><div class="mdui-collapse-item-body mdui-list mdui-list-dense"><a class="mdui-ripple sidebar_archives-link" href="/blog/archives/2019/06/">六月 2019<span class="mdui-ripple sidebar_archives-count">91</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/archives/2018/06/">六月 2018<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/archives/2018/03/">三月 2018<span class="mdui-ripple sidebar_archives-count">18</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/archives/2017/06/">六月 2017<span class="mdui-ripple sidebar_archives-count">1</span></a></div></div><div class="mdui-collapse-item"><div class="mdui-collapse-item-header mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-brown">bookmark</i><div class="mdui-list-item-content">标签</div><i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i></div><div class="mdui-collapse-item-body mdui-list mdui-list-dense"><a class="mdui-ripple sidebar_archives-link" href="/blog/tags/DB/">DB<span class="mdui-ripple sidebar_archives-count">18</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/tags/MongoDB/">MongoDB<span class="mdui-ripple sidebar_archives-count">18</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/tags/hexo/">hexo<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/tags/install-package/">install-package<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/blog/tags/windows/">windows<span class="mdui-ripple sidebar_archives-count">1</span></a></div></div><a href="/blog/about" class="mdui-list-item mdui-ripple"><i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-purple">person</i><div class="mdui-list-item-content">关于</div></a></div></aside><main id="main" class="mdui-m-t-5 fadeIn animated"><link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css"><style>#main article .mdui-card-content .center-block{display:block!important;margin-right:auto!important;margin-left:auto!important}</style><article class="mdui-card mdui-m-b-5 mdui-hoverable"><header class="mdui-card-media"><img src="/blog/imgs//random/material-1.png" style="max-height:240px"><div class="mdui-card-media-covered"><div class="mdui-card-primary"><div class="mdui-card-primary-title"></div><div class="mdui-card-primary-subtitle"><i class="iconfont">&#xe697;</i> 2019-06-12 / <i class="iconfont">&#xe601;</i> Roy Lau &nbsp;&nbsp; <span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont">&#xe7fd;</i> <span id="busuanzi_value_page_pv"></span></span></div></div></div><div class="mdui-card-menu"><button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#qrcode', align: 'right'}"><i class="mdui-icon material-icons">devices</i></button><ul class="mdui-menu" id="qrcode"><li class="mdui-menu-item"><a class="mdui-text-center mdui-ripple">发送到手机</a></li><li class="mdui-menu-item" disabled><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAAC5ElEQVR42u3aS5KjMBAFQN//0jPbjpiAfq9kjwElK8LGQqlFV9fn9WfL64WNjY2NjY2NjY19SfYrvn4+f/Tbw1ce/Oro23/vV/aMjY2NvQP7lz/9p5tueflq5yvnz2NjY2Pvw86D1uHScfjJn0n2cL5nbGxsbOxZuDpKHs4/P38SGxsbG/u9ASwv9yRHkD+DjY2Njb1SVEp4edtgVjb6Qi0NGxsb+/LslUbvt+6/3N/GxsbGvgx75WrbBu0YUBu0ftktNjY29kPZ+RbrgBE3cZNWQd42GA5fYmNjY9+WfY5vg1ZyiHkhKQ91UVsaGxsb+6HsfKG2NdsWqtoSUn5A2NjY2M9mJ0eQB6RknbwBPDuOuj2AjY2NfXP2SgIwA+fI/zqphI2Njf0gdvuy5ODyElKeftSHhY2Njf1Qdp545OFt9tsE3JausLGxsXdjr9wXozPliM/sjdjY2Nj7sJN/8VcGNN8V9to9DzMwbGxs7Juzkxe0Rf/ZlRxfPVSEjY2NvQG7LdbnIz6zo5yNBy01erGxsbFvyG43l7cT8hbsrFFRHzc2Njb2BuxZAzUv7icJTL6H9lixsbGxn8puk4rZCOZ6YzgPq9jY2Ni7sXNSDstL9nnzOC8nLaUi2NjY2I9jt+Myyf1KSpMfEzY2NvZu7E8kD+8dBmoHdKJUBBsbG/sR7KIoE2wrWaFdLRkVGtbSsLGxsR/EflcTNwla+Rvzo6xTEWxsbOzHsduCTv7KdkynbUJ/PG5jY2Nj34q90nZNQtRKwehVXtjY2Nj7sNsrbxW0Kcq7Gsx1oxcbGxv75uw2JLTfzj5PeG16g42Njf1sdhK0ZulEu37bQi5CHTY2NvYG7LwYNCOtjPUUDV1sbGxs7BF7JamYJTx1WQobGxsbe1SUn7Uc2gZwUmzCxsbG3oHdFn3Wk4rZmnm6go2Njb0Pe9boXSn056GuDV0f729jY2NjX4y9z4WNjY2NjY2NjY19mesvRADYu3mtiqEAAAAASUVORK5CYII="></li></ul><button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#share_menu', align: 'right'}"><i class="mdui-icon material-icons">share</i></button><ul class="mdui-menu" id="share_menu"><li class="mdui-menu-item"><a href="http://service.weibo.com/share/share.php?appkey=&title=&url=https://roy-lau.github.io/blog/2019/06/12/Linux/centOS/docker/image-usage/&pic=https://roy-lau.github.io/blog/blog/images/favicon.jpg&searchPic=false&style=simple" target="_blank" class="mdui-ripple">分享到微博</a></li><li class="mdui-menu-item"><a href="http://connect.qq.com/widget/shareqq/index.html?site=Roy Lau&title=&summary=&pics=https://roy-lau.github.io/blog/blog/images/favicon.jpg&url=https://roy-lau.github.io/blog/2019/06/12/Linux/centOS/docker/image-usage/" target="_blank" class="mdui-ripple">分享到QQ</a></li><li class="mdui-menu-item"><a href="https://twitter.com/intent/tweet?text=&url=https://roy-lau.github.io/blog/2019/06/12/Linux/centOS/docker/image-usage/&via=Roy Lau" target="_blank" class="mdui-ripple">分享到Twitter</a></li><li class="mdui-menu-item"><a href="https://www.facebook.com/sharer/sharer.php?u=https://roy-lau.github.io/blog/2019/06/12/Linux/centOS/docker/image-usage/" target="_blank" class="mdui-ripple">分享到Facebook</a></li><li class="mdui-menu-item"><a href="https://plus.google.com/share?url=https://roy-lau.github.io/blog/2019/06/12/Linux/centOS/docker/image-usage/" target="_blank" class="mdui-ripple">分享到Google+</a></li><li class="mdui-menu-item"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://roy-lau.github.io/blog/2019/06/12/Linux/centOS/docker/image-usage/&title=" target="_blank" class="mdui-ripple">分享到LinkedIn</a></li><li class="mdui-menu-item"><a href="https://telegram.me/share/url?url=https://roy-lau.github.io/blog/2019/06/12/Linux/centOS/docker/image-usage/&text=" target="_blank" class="mdui-ripple">分享到Telegram</a></li></ul></div></header><div class="mdui-card-content mdui-typo"><h1 id="docker-镜像使用"><a href="#docker-镜像使用" class="headerlink" title="docker 镜像使用"></a>docker 镜像使用</h1><ul><li><a href="./command.md">相关命令</a></li><li><a href="./install.md">安装使用（nginx，tomcat，mysql，oracle 11g）</a></li><li><a href="./container-usage.md">容器使用</a></li><li><a href="./image-usage.md">镜像使用</a></li><li><a href="./container-connection.md">容器链接</a></li></ul><h3 id="Docker-镜像使用"><a href="#Docker-镜像使用" class="headerlink" title="Docker 镜像使用"></a>Docker 镜像使用</h3><p>当运行容器时，使用的镜像如果在本地中不存在，docker 就会自动从 docker 镜像仓库中下载，默认是从 Docker Hub 公共镜像源下载。</p><blockquote><p>主要学习点：</p></blockquote><pre><code>1、管理和使用本地 Docker 主机镜像
2、创建镜像
</code></pre><p>列出镜像列表</p><p>我们可以使用 <code>docker images</code> 来列出本地主机上的镜像。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">~$ docker images           </span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">ubuntu              14.04               90d5884b1ee0        5 days ago          188 MB</span><br><span class="line">php                 5.6                 f40e9e0f10c8        9 days ago          444.8 MB</span><br><span class="line">nginx               latest              6f8d099c3adc        12 days ago         182.7 MB</span><br><span class="line">mysql               5.6                 f2e8d6c772c0        3 weeks ago         324.6 MB</span><br><span class="line">httpd               latest              02ef73cf1bc0        3 weeks ago         194.4 MB</span><br><span class="line">ubuntu              15.10               4e3b13c8a266        4 weeks ago         136.3 MB</span><br><span class="line">hello-world         latest              690ed74de00f        6 months ago        960 B</span><br><span class="line">training/webapp     latest              6fae60ef3446        11 months ago       348.8 MB</span><br></pre></td></tr></table></figure><p>各个选项说明:</p><ul><li><strong>REPOSITORY</strong> ：表示镜像的仓库源</li><li><strong>TAG</strong> ：镜像的标签</li><li><strong>IMAGE ID</strong> ：镜像ID</li><li><strong>CREATED</strong> ：镜像创建时间</li><li><strong>SIZE</strong> ：镜像大小</li></ul><p>同一仓库源可以有多个 <code>TAG</code> ，代表这个仓库源的不同个版本，如ubuntu仓库源里，有 <code>15.10、14.04</code> 等多个不同的版本，我们使用 <code>REPOSITORY:TAG</code><br>来定义不同的镜像。</p><blockquote><p>如果要使用版本为15.10的ubuntu系统镜像来运行容器时，命令如下：</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~$ docker run -t -i ubuntu:15.10 /bin/bash </span><br><span class="line">root@d77ccb2e5cca:/<span class="comment">#</span></span><br></pre></td></tr></table></figure><blockquote><p>如果要使用版本为14.04的ubuntu系统镜像来运行容器时，命令如下：</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~$ docker run -t -i ubuntu:14.04 /bin/bash </span><br><span class="line">root@39e968165990:/<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>如果不指定一个镜像的版本标签，例如只使用 <code>ubuntu，docker</code> 将默认使用 <code>ubuntu:latest</code> 镜像。</p><h5 id="获取一个新的镜像"><a href="#获取一个新的镜像" class="headerlink" title="获取一个新的镜像"></a>获取一个新的镜像</h5><blockquote><p>当我们在本地主机上使用一个不存在的镜像时 Docker 就会自动下载这个镜像。如果我们想预先下载这个镜像，我们可以使用 docker pull 命令来下载它。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">~$ docker pull ubuntu:13.10</span><br><span class="line">13.10: Pulling from library/ubuntu</span><br><span class="line">6599cadaf950: Pull complete </span><br><span class="line">23eda618d451: Pull complete </span><br><span class="line">f0be3084efe9: Pull complete </span><br><span class="line">52de432f084b: Pull complete </span><br><span class="line">a3ed95caeb02: Pull complete </span><br><span class="line">Digest: sha256:15b79a6654811c8d992ebacdfbd5152fcf3d165e374e264076aa435214a947a3</span><br><span class="line">Status: Downloaded newer image <span class="keyword">for</span> ubuntu:13.10</span><br></pre></td></tr></table></figure><p>下载完成后，我们可以直接使用这个镜像来运行容器。</p><h5 id="查找镜像"><a href="#查找镜像" class="headerlink" title="查找镜像"></a>查找镜像</h5><blockquote><p>Docker Hub 网址为： <a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a></p></blockquote><p>可以使用 <code>docker search</code> 命令来搜索镜像。比如我们需要一个 <code>httpd</code> 的镜像来作为我们的 web 服务。我们可以通过 <code>docker search</code> 命令搜索 httpd 来寻找适合我们的镜像。</p><pre><code>~$  docker search httpd
</code></pre><ul><li><strong>NAME</strong> :镜像仓库源的名称</li><li><strong>DESCRIPTION</strong> :镜像的描述</li><li><strong>OFFICIAL</strong> :是否docker官方发布</li></ul><h5 id="拖取镜像"><a href="#拖取镜像" class="headerlink" title="拖取镜像"></a>拖取镜像</h5><blockquote><p>使用命令 docker pull 来下载镜像。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">~$ docker pull httpd</span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/httpd</span><br><span class="line">8b87079b7a06: Pulling fs layer </span><br><span class="line">a3ed95caeb02: Download complete </span><br><span class="line">0d62ec9c6a76: Download complete </span><br><span class="line">a329d50397b9: Download complete </span><br><span class="line">ea7c1f032b5c: Waiting </span><br><span class="line">be44112b72c7: Waiting</span><br></pre></td></tr></table></figure><p>下载完成后，就可以使用这个镜像了。</p><pre><code>~$ docker run httpd
</code></pre><h5 id="创建镜像"><a href="#创建镜像" class="headerlink" title="创建镜像"></a>创建镜像</h5><p>从docker镜像仓库中下载的镜像不能满足需求时，可以通过以下两种方式对镜像进行更改。</p><ol><li>从已经创建的容器中更新镜像，并且提交这个镜像</li><li>使用 Dockerfile 指令来创建一个新的镜像</li></ol><h5 id="更新镜像"><a href="#更新镜像" class="headerlink" title="更新镜像"></a>更新镜像</h5><blockquote><p>更新镜像之前，需要使用镜像来创建一个容器。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~$ docker run -t -i ubuntu:15.10 /bin/bash</span><br><span class="line">root@e218edb10161:/<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>在运行的容器内使用 <code>apt-get update</code> 命令进行更新。</p><p>在完成操作之后，输入 <code>exit</code> 命令来退出这个容器。</p><p>此时ID为e218edb10161的容器，根据更改的容器。通过命令 <code>docker commit</code> 来提交容器副本。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~$ docker commit -m=<span class="string">"has update"</span> -a=<span class="string">"firstDocker"</span> e218edb10161 firstDocker/ubuntu:v2</span><br><span class="line">sha256:70bf1840fd7c0d2d8ef0a42a817eb29f854c1af8f7c59fc03ac7bdee9545aff8</span><br></pre></td></tr></table></figure><p>各个参数说明：</p><ul><li><strong>-m</strong> :提交的描述信息</li><li><strong>-a</strong> :指定镜像作者</li><li><strong>e218edb10161</strong> : 容器ID</li><li><strong>firstDocker/ubuntu:v2</strong> :指定要创建的目标镜像名</li></ul><p>我们可以使用 docker images 命令来查看我们的新镜像 <code>firstDocker/ubuntu:v2</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">~$ docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">firstDocker/ubuntu       v2                  70bf1840fd7c        15 seconds ago      158.5 MB</span><br><span class="line">ubuntu              14.04               90d5884b1ee0        5 days ago          188 MB</span><br><span class="line">php                 5.6                 f40e9e0f10c8        9 days ago          444.8 MB</span><br><span class="line">nginx               latest              6f8d099c3adc        12 days ago         182.7 MB</span><br><span class="line">mysql               5.6                 f2e8d6c772c0        3 weeks ago         324.6 MB</span><br><span class="line">httpd               latest              02ef73cf1bc0        3 weeks ago         194.4 MB</span><br><span class="line">ubuntu              15.10               4e3b13c8a266        4 weeks ago         136.3 MB</span><br><span class="line">hello-world         latest              690ed74de00f        6 months ago        960 B</span><br><span class="line">training/webapp     latest              6fae60ef3446        12 months ago       348.8 MB</span><br></pre></td></tr></table></figure><p>使用新镜像 <code>firstDocker/ubuntu</code> 来启动一个容器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~$ docker run -t -i firstDocker/ubuntu:v2 /bin/bash                            </span><br><span class="line">root@1a9fbdeb5da3:/<span class="comment">#</span></span><br></pre></td></tr></table></figure><h5 id="构建镜像"><a href="#构建镜像" class="headerlink" title="构建镜像"></a>构建镜像</h5><p>使用命令 <code>docker build</code> ， 从零开始来创建一个新的镜像。需要创建一个 <strong>Dockerfile</strong> 文件，其中包含一组指令来告诉 Docker 如何构建镜像。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">~$ cat Dockerfile </span><br><span class="line">FROM    centos:6.7</span><br><span class="line">MAINTAINER      Fisher <span class="string">"fisher@sudops.com"</span></span><br><span class="line">RUN     /bin/<span class="built_in">echo</span> <span class="string">'root:123456'</span> |chpasswd</span><br><span class="line">RUN     useradd firstDocker</span><br><span class="line">RUN     /bin/<span class="built_in">echo</span> <span class="string">'firstDocker:123456'</span> |chpasswd</span><br><span class="line">RUN     /bin/<span class="built_in">echo</span> -e <span class="string">"LANG=\"en_US.UTF-8\""</span> &gt;/etc/default/<span class="built_in">local</span></span><br><span class="line">EXPOSE  22</span><br><span class="line">EXPOSE  80</span><br><span class="line">CMD     /usr/sbin/sshd -D</span><br></pre></td></tr></table></figure><p><em>每一个指令都会在镜像上创建一个新的层，每一个指令的前缀都必须是大写的。</em><br><em>第一条FROM，指定使用哪个镜像源</em><br><em>RUN 指令告诉docker 在镜像内执行命令，安装了什么。。。</em><br><em>然后，使用 Dockerfile 文件，通过 docker build 命令来构建一个镜像。</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">~$ docker build -t firstDocker/centos:6.7 .</span><br><span class="line">Sending build context to Docker daemon 17.92 kB</span><br><span class="line">Step 1 : FROM centos:6.7</span><br><span class="line"> ---&amp;gt; d95b5ca17cc3</span><br><span class="line">Step 2 : MAINTAINER Fisher <span class="string">"fisher@sudops.com"</span></span><br><span class="line"> ---&amp;gt; Using cache</span><br><span class="line"> ---&amp;gt; 0c92299c6f03</span><br><span class="line">Step 3 : RUN /bin/<span class="built_in">echo</span> <span class="string">'root:123456'</span> |chpasswd</span><br><span class="line"> ---&amp;gt; Using cache</span><br><span class="line"> ---&amp;gt; 0397ce2fbd0a</span><br><span class="line">Step 4 : RUN useradd firstDocker</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li><strong>-t</strong> ：指定要创建的目标镜像名</li><li><strong>.</strong> ：Dockerfile 文件所在目录，可以指定Dockerfile 的绝对路径</li></ul><p>使用 <code>docker images</code> 查看创建的镜像已经在列表中存在,镜像ID为 <code>860c279d2fec</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">~$ docker images </span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED              SIZE</span><br><span class="line">firstDocker/centos       6.7                 860c279d2fec        About a minute ago   190.6 MB</span><br><span class="line">firstDocker/ubuntu       v2                  70bf1840fd7c        17 hours ago         158.5 MB</span><br><span class="line">ubuntu              14.04               90d5884b1ee0        6 days ago           188 MB</span><br><span class="line">php                 5.6                 f40e9e0f10c8        10 days ago          444.8 MB</span><br><span class="line">nginx               latest              6f8d099c3adc        12 days ago          182.7 MB</span><br><span class="line">mysql               5.6                 f2e8d6c772c0        3 weeks ago          324.6 MB</span><br><span class="line">httpd               latest              02ef73cf1bc0        3 weeks ago          194.4 MB</span><br><span class="line">ubuntu              15.10               4e3b13c8a266        5 weeks ago          136.3 MB</span><br><span class="line">hello-world         latest              690ed74de00f        6 months ago         960 B</span><br><span class="line">centos              6.7                 d95b5ca17cc3        6 months ago         190.6 MB</span><br><span class="line">training/webapp     latest              6fae60ef3446        12 months ago        348.8 MB</span><br></pre></td></tr></table></figure><p>使用新的镜像来创建容器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~$ docker run -t -i firstDocker/centos:6.7  /bin/bash</span><br><span class="line">[root@41c28d18b5fb /]<span class="comment"># id firstDocker</span></span><br><span class="line">uid=500(firstDocker) gid=500(firstDocker) groups=500(firstDocker)</span><br></pre></td></tr></table></figure><h5 id="设置镜像标签"><a href="#设置镜像标签" class="headerlink" title="设置镜像标签"></a>设置镜像标签</h5><p>使用 <code>docker tag</code> 命令，为镜像添加一个新的标签。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~$ docker tag 860c279d2fec firstDocker/centos:dev</span><br></pre></td></tr></table></figure><p><code>docker tag</code> 镜像ID，这里是 <code>860c279d2fec</code> ,用户名称、镜像源名(repository name)和新的标签名(tag)。</p><p>使用 <code>docker images</code> 命令可以看到，ID为860c279d2fec的镜像多一个标签。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">~$ docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">firstDocker/centos       6.7                 860c279d2fec        5 hours ago         190.6 MB</span><br><span class="line">firstDocker/centos       dev                 860c279d2fec        5 hours ago         190.6 MB</span><br><span class="line">firstDocker/ubuntu       v2                  70bf1840fd7c        22 hours ago        158.5 MB</span><br><span class="line">ubuntu              14.04               90d5884b1ee0        6 days ago          188 MB</span><br><span class="line">php                 5.6                 f40e9e0f10c8        10 days ago         444.8 MB</span><br><span class="line">nginx               latest              6f8d099c3adc        13 days ago         182.7 MB</span><br><span class="line">mysql               5.6                 f2e8d6c772c0        3 weeks ago         324.6 MB</span><br><span class="line">httpd               latest              02ef73cf1bc0        3 weeks ago         194.4 MB</span><br><span class="line">ubuntu              15.10               4e3b13c8a266        5 weeks ago         136.3 MB</span><br><span class="line">hello-world         latest              690ed74de00f        6 months ago        960 B</span><br><span class="line">centos              6.7                 d95b5ca17cc3        6 months ago        190.6 MB</span><br><span class="line">training/webapp     latest              6fae60ef3446        12 months ago       348.8 MB</span><br></pre></td></tr></table></figure><blockquote class="mdui-m-t-5"><strong>本文遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">CC BY-NC-SA 4.0</a> 许可协议</strong><br><strong>本文链接：</strong><a href="https://roy-lau.github.io/blog/2019/06/12/Linux/centOS/docker/image-usage/">https://roy-lau.github.io/blog/2019/06/12/Linux/centOS/docker/image-usage/</a></blockquote><div class="mdui-text-center"><button class="mdui-fab mdui-color-deep-orange mdui-text-color-white mdui-ripple" mdui-dialog="{target: '#donate'}" mdui-tooltip="{content: '打赏', position: 'top'}"><i class="mdui-icon material-icons">local_cafe</i></button></div></div><footer class="mdui-card-actions"></footer><div class="mdui-dialog" id="donate"><div class="mdui-tab mdui-tab-centered" mdui-tab><a href="#donate-0" class="mdui-ripple">支付宝</a> <a href="#donate-1" class="mdui-ripple">微信支付</a></div><div id="donate-0" class="mdui-p-a-2 mdui-typo mdui-text-center"><img src="/images/alipay.jpg" style="width:300px"></div><div id="donate-1" class="mdui-p-a-2 mdui-typo mdui-text-center"><img src="/images/wechat.jpg" style="width:300px"></div></div></article><script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script><script>$("#main article .mdui-card-content img.fancybox").on("click",function(c){$.fancybox.open({src:$(this).attr("src")})})</script><nav id="paginator"><a rel="prev" class="extend prev" href="/blog/2019/06/12/Linux/centOS/docker/install/"><button aria-label="prev" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_back</i></button> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;上一篇</a><div class="spacer"></div><a rel="next" class="extend next" href="/blog/2019/06/12/Linux/centOS/docker/container-connection/">下一篇&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <button aria-label="next" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_forward</i></button></a></nav><div id="comment" class="mdui-m-t-5"><style>#feedAv,#pop_ad{display:none!important;position:absolute!important;z-index:-9999;left:-1000px;opacity:0!important}</style><div id="SOHUCS" sid="cjwu99k9p005svohw9i23l5bl"></div><script type="text/javascript">!function(){var e,t,n,a="cyubhC2Dq",c="prod_e4cce65003c5bed049fefcb8a6f09e12";(window.innerWidth||document.documentElement.clientWidth)<960?window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id='+a+"&conf="+c+'"><\/script>'):(e=function(){window.changyan.api.config({appid:a,conf:c})},t=document.getElementsByTagName("head")[0]||document.head||document.documentElement,(n=document.createElement("script")).setAttribute("type","text/javascript"),n.setAttribute("charset","UTF-8"),n.setAttribute("src","http://changyan.sohu.com/upload/changyan.js"),window.attachEvent?n.onreadystatechange=function(){var t=n.readyState;"loaded"!==t&&"complete"!==t||(n.onreadystatechange=null,e())}:n.onload=e,t.appendChild(n))}()</script></div></main><footer id="footer" class="mdui-m-t-5 mdui-p-y-3 mdui-color-theme"><div class="mdui-p-y-0 mdui-text-center"><a href="https://weibo.com/2360828682/profile" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xec7e;</i></a> <a href="https://github.com/niemingzhao" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe7ab;</i></a> <a href="https://www.zhihu.com/people/nie-1-58" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe6c0;</i></a> <a href="tencent://message/?uin=1432440963&Menu=yes" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe651;</i></a></div><div class="mdui-p-y-1 mdui-text-center">Copyright &copy; 2016 - 2019 Roy Lau<br>Powered by <a href="https://github.com/roylau" target="_blank" class="mdui-text-color-theme-accent">RoyLau</a> | 鲁ICP备19009266号-1<br><span id="busuanzi_container_site_pv" style="display:none"><i class="iconfont">&#xe7fd;</i> <span id="busuanzi_value_site_pv"></span></span> &nbsp;&nbsp; <span id="busuanzi_container_site_uv" style="display:none"><i class="iconfont">&#xe601;</i> <span id="busuanzi_value_site_uv"></span></span></div></footer><button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-theme-accent"><i class="mdui-icon material-icons">arrow_upward</i></button><script async src="http://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/blog/js/mdui.js"></script><script src="/blog/js/script.js"></script></body></html>