(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{377:function(s,a,t){"use strict";t.r(a);var n=t(1),r=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"在-docker-上安装使用-sqlserver"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-docker-上安装使用-sqlserver"}},[s._v("#")]),s._v(" 在 docker 上安装使用 SqlServer")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/sql/linux/quickstart-install-connect-docker?view=sql-server-2017&pivots=cs1-bash",target:"_blank",rel:"noopener noreferrer"}},[s._v("参考"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拉取 2017 版的SqlServer")]),s._v("\ndocker pull mcr.microsoft.com/mssql/server:2017-latest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行 SqlServer 并创建账号密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" docker run -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ACCEPT_EULA=Y"')]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SA_PASSWORD=<YourStrong@Passw0rd>"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1433")]),s._v(":1433 --name mssql "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n   -d mcr.microsoft.com/mssql/server:2017-latest\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下面这条已成功启动")]),s._v("\ndocker run -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ACCEPT_EULA=Y'")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SA_PASSWORD=sa@123456"')]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1433")]),s._v(":1433 --name mssql --restart always -d mcr.microsoft.com/mssql/server:2017-latest\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复制文件到容器中")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" ."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("RYCPDC_C20191111new.bak 1343055f3205:/var/opt/mssql\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入镜像，连接本地数据库")]),s._v("\n/opt/mssql-tools/bin/sqlcmd -S localhost -U SA -P "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sa@123456"')]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建个卷（volume）")]),s._v("\n\ndocker volume create mssql-dir\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 卷（volume）")]),s._v("\n\ndocker volume inspect mssql-dir\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 尝试加上 卷 不行（The database 'master' cannot be opened because it is version 904. This server supports version 869 and earlier. A downgrade path is not supported）猜测可能是我电脑ubuntu的问题")]),s._v("\ndocker run -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ACCEPT_EULA=Y'")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SA_PASSWORD=sa@123456"')]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1433")]),s._v(":1433 --name mssql --restart always -v mssql-dir:/var/opt/mssql -d mcr.microsoft.com/mssql/server:2017-latest\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以正常运行，但是无法连接")]),s._v("\ndocker run -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ACCEPT_EULA=Y'")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SA_PASSWORD=sa@123456"')]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1433")]),s._v(":1433 --name mssql --restart always -v c:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Workspace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("dbs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mssql:/var/opt/mssql -v c:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("Workspace"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("dbs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("mssql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("backup:/backup -d mcr.microsoft.com/mssql/server:2017-latest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("ul",[t("li",[s._v("--name sqlserver ：设置运行容器名称")]),s._v(" "),t("li",[s._v("--restart always   ：设置容器自动重新启")]),s._v(" "),t("li",[s._v("-v /opt/netcore/mssql:/var/opt/mssql  挂在目录，把容器数据库挂在到自定义目录")]),s._v(" "),t("li",[s._v("-e 'ACCEPT_EULA=Y'  ：提示您接受最终用户许可协议。如果您不同意，安装将不会继续")]),s._v(" "),t("li",[s._v("-e SA_PASSWORD='sa@123456' ：设置管理员SA用户和密码（必填参数，密码大于八位，并包含特殊符号）")]),s._v(" "),t("li",[s._v("-e SQLSERVER_DATABASE=first ：创建一个叫“first”的数据库")]),s._v(" "),t("li",[s._v("-e SQLSERVER_USER=roy  ：给“first”的数据库添加一个“roy”登录用户，权限只能访问first数据库")]),s._v(" "),t("li",[s._v("-e SQLSERVER_PASSWORD='sa@123456'  ：给“roy”用户设置登录密码")]),s._v(" "),t("li",[s._v("-p 1434:1433 ：设置端口监听外部端口1433，容器内部开放端口1433")]),s._v(" "),t("li",[s._v("mcr.microsoft.com/mssql/server:2017-latest ：运行镜像")])]),s._v(" "),t("div",{staticClass:"language-SQL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RESTORE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("DBName_XXX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'C:\\DBbak\\TestDBbackup.bak'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v("\nMOVE N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'TestDB'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'C:\\DB\\DBName_XXX.mdf'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \nMOVE N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'TestDB_log'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'C:\\DB\\DBName_XXX_log.ldf'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FILE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" NOUNLOAD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" STATS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("master"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nGO\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" LOGIN user_XXX "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v("\nPASSWORD "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pwd_XXX'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" DEFAULT_DATABASE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DBName_XXX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" CHECK_EXPIRATION"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" CHECK_POLICY"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OFF")]),s._v("\nGO\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRINT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'CREATE LOGIN OK.'")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" DBName_XXX\nGO\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" user_XXX "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" LOGIN user_XXX "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" DEFAULT_SCHEMA "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dbo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \nGO\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" sp_addrolemember N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'db_owner'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'user_XXX'")]),s._v("\nGO\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRINT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'CREATE USER OK.'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 将“C:\\DBbak\\TestDBbackup.bak”替换为你数据库备份的文件路径")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- DBName_XXX：数据库名")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- user_XXX：数据库登录用户名")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- pwd_XXX：数据库登录用户密码")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])]),t("div",{staticClass:"language-SQL line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RESTORE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("DBName_XXX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'C:\\DBbak\\TestDBbackup.bak'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v("\nMOVE N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'TestDB'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'C:\\DB\\DBName_XXX.mdf'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \nMOVE N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'TestDB_log'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'C:\\DB\\DBName_XXX_log.ldf'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FILE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" NOUNLOAD"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" STATS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("master"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nGO\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" LOGIN user_XXX "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v("\nPASSWORD "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'pwd_XXX'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" DEFAULT_DATABASE "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DBName_XXX"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" CHECK_EXPIRATION"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OFF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" CHECK_POLICY"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OFF")]),s._v("\nGO\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRINT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'CREATE LOGIN OK.'")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" DBName_XXX\nGO\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" user_XXX "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FOR")]),s._v(" LOGIN user_XXX "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" DEFAULT_SCHEMA "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dbo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \nGO\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXEC")]),s._v(" sp_addrolemember N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'db_owner'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'user_XXX'")]),s._v("\nGO\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRINT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'CREATE USER OK.'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 将“C:\\DBbak\\TestDBbackup.bak”替换为你数据库备份的文件路径")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- DBName_XXX：数据库名")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- user_XXX：数据库登录用户名")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- pwd_XXX：数据库登录用户密码")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BACKUP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("first")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/var/opt/mssql/data\\first1.bak'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v("\n  NAME "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'first - Backup'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  NOFORMAT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" NOINIT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SKIP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  STATS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RESTORE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("first")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TO")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/var/opt/mssql/data\\first.bak'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v("\n  NAME "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'first - Backup'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  NOFORMAT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" NOINIT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SKIP"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  STATS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n\n\n使用"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SQL")]),s._v("最简单备份"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("还原数据库\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* 备份 */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("backup")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("database")]),s._v(" TestDB "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DISK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/var/opt/mssql/data\\test.bak'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("backup")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("database")]),s._v(" Test "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("disk")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'D:/Test.bak'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* 还原 */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("restore")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("database")]),s._v(" Test "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("disk")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'D:/Test.bak'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("restore")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("database")]),s._v(" TestDB "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("disk")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/var/opt/mssql/data\\test.bak'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("restore")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("database")]),s._v(" TestDB "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("disk")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("N"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/var/opt/mssql/data\\RYCPDC_C20191111new.bak'")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mssql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tools"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sqlcmd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("S localhost "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("U SA "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("P "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sa@123456'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Q "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'RESTORE DATABASE TestDB FROM DISK = "/var/opt/mssql/test.bak" WITH MOVE "TestDB" TO "/var/opt/mssql/data/TestDB.mdf" , MOVE "TestDB_log" TO "/var/opt/mssql/data/TestDB.ldf"\'')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);