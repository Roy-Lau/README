(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{197:function(o,t,e){o.exports=e.p+"assets/img/mongodump.37a2000c.png"},198:function(o,t,e){o.exports=e.p+"assets/img/mongorestore.fac865f8.png"},283:function(o,t,e){"use strict";e.r(t);var v=e(1),s=Object(v.a)({},(function(){var o=this,t=o.$createElement,v=o._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":o.$parent.slotKey}},[v("h1",{attrs:{id:"mongodb-备份-mongodump-与恢复-mongorestore"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-备份-mongodump-与恢复-mongorestore"}},[o._v("#")]),o._v(" MongoDB 备份(mongodump)与恢复(mongorestore)")]),o._v(" "),v("p",[v("RouterLink",{attrs:{to:"/data-base/mongodb/"}},[o._v("目录")])],1),o._v(" "),v("h4",{attrs:{id:"mongodb数据备份"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mongodb数据备份"}},[o._v("#")]),o._v(" MongoDB数据备份")]),o._v(" "),v("blockquote",[v("p",[o._v("在"),v("code",[o._v("Mongodb")]),o._v("中我们使用"),v("code",[o._v("mongodump")]),o._v("命令来备份"),v("code",[o._v("MongoDB")]),o._v("数据。该命令可以导出所有数据到指定目录中。")])]),o._v(" "),v("blockquote",[v("p",[v("code",[o._v("mongodump")]),o._v("命令可以通过参数指定导出的数据量级转存的服务器。")])]),o._v(" "),v("p",[o._v("语法")]),o._v(" "),v("div",{staticClass:"language-sql line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-sql"}},[v("code",[v("span",{pre:!0,attrs:{class:"token operator"}},[o._v(">")]),o._v("mongodump "),v("span",{pre:!0,attrs:{class:"token operator"}},[o._v("-")]),o._v("h dbhost "),v("span",{pre:!0,attrs:{class:"token operator"}},[o._v("-")]),o._v("d dbname "),v("span",{pre:!0,attrs:{class:"token operator"}},[o._v("-")]),o._v("o dbdirectory\n")])]),o._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[o._v("1")]),v("br")])]),v("ul",[v("li",[v("strong",[o._v("-h：")]),o._v(" "),v("code",[o._v("MongDB")]),o._v("所在服务器地址，例如："),v("code",[o._v("127.0.0.1")]),o._v("，当然也可以指定端口号："),v("code",[o._v("127.0.0.1:27017")])]),o._v(" "),v("li",[v("strong",[o._v("-d：")]),o._v(" 需要备份的数据库实例，例如："),v("code",[o._v("test")])]),o._v(" "),v("li",[v("strong",[o._v("-o：")]),o._v(" 备份的数据存放位置，例如："),v("code",[o._v("c:\\data\\dump")]),o._v("，当然该目录需要提前建立，在备份完成后，系统自动在"),v("code",[o._v("dump")]),o._v("目录下建立一个"),v("code",[o._v("test")]),o._v("目录，这个目录里面存放该数据库实例的备份数据。")])]),o._v(" "),v("p",[o._v("实例")]),o._v(" "),v("p",[o._v("在本地使用 "),v("code",[o._v("27017")]),o._v(" 启动你的"),v("code",[o._v("mongod")]),o._v("服务。打开命令提示符窗口，进入"),v("code",[o._v("MongoDB")]),o._v("安装目录的"),v("code",[o._v("bin")]),o._v("目录输入命令"),v("code",[o._v("mongodump")]),o._v(":")]),o._v(" "),v("div",{staticClass:"language-sql line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-sql"}},[v("code",[v("span",{pre:!0,attrs:{class:"token operator"}},[o._v(">")]),o._v("mongodump\n")])]),o._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[o._v("1")]),v("br")])]),v("p",[o._v("执行以上命令后，客户端会连接到ip为 "),v("code",[o._v("127.0.0.1")]),o._v(" 端口号为 "),v("code",[o._v("27017")]),o._v(" 的"),v("code",[o._v("MongoDB")]),o._v("服务上，并备份所有数据到 "),v("code",[o._v("bin/dump/")]),o._v(" 目录中。命令输出结果如下：")]),o._v(" "),v("p",[v("img",{attrs:{src:e(197),alt:"mongodump输出结果图",title:"mongodump输出结果图"}})]),o._v(" "),v("p",[o._v("mongodump 命令可选参数列表如下所示：")]),o._v(" "),v("table",[v("thead",[v("tr",[v("th",[o._v("语法")]),o._v(" "),v("th",[o._v("描述")]),o._v(" "),v("th",[o._v("实例")])])]),o._v(" "),v("tbody",[v("tr",[v("td",[v("code",[o._v("mongodump --host HOST_NAME --port PORT_NUMBER")])]),o._v(" "),v("td",[o._v("该命令将备份所有"),v("code",[o._v("MongoDB")]),o._v("数据")]),o._v(" "),v("td",[v("code",[o._v("mongodump --host runoob.com --port 27017")])])]),o._v(" "),v("tr",[v("td",[v("code",[o._v("mongodump --dbpath DB_PATH --out BACKUP_DIRECTORY")])]),o._v(" "),v("td"),o._v(" "),v("td",[v("code",[o._v("mongodump --dbpath /data/db/ --out /data/backup/")])])]),o._v(" "),v("tr",[v("td",[v("code",[o._v("mongodump --collection COLLECTION --db DB_NAME")])]),o._v(" "),v("td",[o._v("该命令将备份指定数据库的集合。")]),o._v(" "),v("td",[v("code",[o._v("mongodump --collection mycol --db test")])])])])]),o._v(" "),v("h4",{attrs:{id:"mongodb数据恢复"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mongodb数据恢复"}},[o._v("#")]),o._v(" MongoDB数据恢复")]),o._v(" "),v("p",[o._v("mongodb使用 mongorestore 命令来恢复备份的数据。")]),o._v(" "),v("p",[o._v("语法")]),o._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[o._v(">mongorestore -h <hostname><:port> -d dbname <path>\n")])]),o._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[o._v("1")]),v("br")])]),v("ul",[v("li",[v("strong",[o._v("--host <:port>, -h <:port>：")]),o._v(" MongoDB所在服务器地址，默认为： localhost:27017")]),o._v(" "),v("li",[v("strong",[o._v("--db , -d ：")]),o._v("    需要恢复的数据库实例，例如：test，当然这个名称也可以和备份时候的不一样，比如test2")]),o._v(" "),v("li",[v("strong",[o._v("--drop：")]),o._v(" 恢复的时候，先删除当前数据，然后恢复备份的数据。就是说，恢复后，备份后添加修改的数据都会被删除，慎用哦！")]),o._v(" "),v("li",[v("strong",[v("code",[o._v("<path>")]),o._v("：")]),o._v(" "),v("code",[o._v("mongorestore")]),o._v(" 最后的一个参数，设置备份数据所在位置，例如："),v("code",[o._v("c:\\data\\dump\\test")]),o._v("。你不能同时指定 "),v("code",[o._v("<path>")]),o._v(" 和 "),v("code",[o._v("--dir")]),o._v(" 选项，"),v("code",[o._v("--dir")]),o._v("也可以设置备份目录。")]),o._v(" "),v("li",[v("strong",[o._v("--dir：")]),o._v(" 指定备份的目录,你不能同时指定 "),v("code",[o._v("<path>")]),o._v(" 和 "),v("code",[o._v("--dir")]),o._v(" 选项。")])]),o._v(" "),v("p",[o._v("接下来我们执行以下命令:")]),o._v(" "),v("div",{staticClass:"language-sql line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-sql"}},[v("code",[v("span",{pre:!0,attrs:{class:"token operator"}},[o._v(">")]),o._v("mongorestore\n")])]),o._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[o._v("1")]),v("br")])]),v("p",[o._v("执行以上命令输出结果如下：")]),o._v(" "),v("p",[v("img",{attrs:{src:e(198),alt:"mongorestore输出结果图",title:"mongorestore输出结果图"}})]),o._v(" "),v("p",[v("a",{staticStyle:{float:"right"},attrs:{href:"mongostat-mongotop"}},[o._v("MongoDB 监控")])])])}),[],!1,null,null,null);t.default=s.exports}}]);